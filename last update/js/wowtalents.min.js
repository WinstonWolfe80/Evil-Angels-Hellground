/* World of Warcraft Recruit By Talent Widget Version 1.3.1
 * by Rob G (Mottie) 2011
 * http://mottie.guildportal.com
 * Dual licensed under the MIT or GPL Version 2.
 */

(function(d){d.wowTalents=function(j,k){var e=this,a;e.$el=d(j).addClass("recruitTalent");e.$el.data("wowTalents",e);e.init=function(){e.options=a=d.extend({},d.wowTalents.defaultOptions,k);var c,f,h,i,b,g;i=a.defaultNeed.toLowerCase();a.defaultNeed="None";if(/^l/.test(i))a.defaultNeed="Low";if(/^m/.test(i))a.defaultNeed="Medium";if(/^h/.test(i))a.defaultNeed="High";b=d('<div><p class="usebg"/><p class="none"/><p class="low"/><p class="medium"/><p class="high"/></div>');a.bg=b.find(".usebg").css("color"); a.cn=b.find(".none").css("color");a.cl=b.find(".low").css("color");a.cm=b.find(".medium").css("color");a.ch=b.find(".high").css("color");a.cd=b.find("."+a.defaultNeed.toLowerCase()).css("color");b="<div>";g=d.wowTalents.talents.root;for(f=0;f<g.length;f++){i=a[g[f].name.toLowerCase().replace(/\s+/g,"")].split(",");b+='<div class="wowclass"><span class="classIcon '+g[f].icon+'"><span';b+=a.useClassColors?' style="color:'+g[f].color+'">':">";b+=g[f].name+'</span></span><span class="talentIcons">';for(h= 0;h<3;h++)c=e.getStyle(i[h]||""),b+='<span class="talentIcon '+a.tooltipClass+" "+g[f].tree[h][1]+" "+c[0].toLowerCase()+(a.tooltipMetadata==="class"?" ":'" '+a.tooltipMetadata+'="')+"{width:"+a.tooltipWidth+"px;color:"+(a.colorBackground?a.bg+";background:":"")+c[1]+';}" title="'+g[f].tree[h][0]+": "+c[0]+'"></span> ';b+="</span></div>"}b+="</div>";e.$el.html(b)};e.getStyle=function(c){c=c.toLowerCase();if(/^n/.test(c))return["None",a.cn];if(/^l/.test(c))return["Low",a.cl];if(/^m/.test(c))return["Medium", a.cm];if(/^h/.test(c))return["High",a.ch];return[a.defaultNeed,a.cd]};e.init()};d.wowTalents.defaultOptions={defaultNeed:"Low",colorBackground:!0,useClassColors:!0,tooltipClass:"tooltip",tooltipWidth:150,tooltipMetadata:"class",deathknight:"",druid:"",hunter:"",mage:"",paladin:"",priest:"",rogue:"",shaman:"",warlock:"",warrior:""};d.wowTalents.talents={root:[{name:"Death Knight",icon:"icon_class_deathknight",color:"#c41f3b",tree:[["Blood","icon_deathknight_blood"],["Frost","icon_deathknight_frost"], ["Unholy","icon_deathknight_unholy"]]},{name:"Druid",icon:"icon_class_druid",color:"#ff7d0a",tree:[["Balance","icon_druid_balance"],["Feral","icon_druid_feral"],["Restoration","icon_druid_restoration"]]},{name:"Hunter",icon:"icon_class_hunter",color:"#abd473",tree:[["Beast Mastery","icon_hunter_beast_mastery"],["Marksmanship","icon_hunter_marksmanship"],["Survival","icon_hunter_survival"]]},{name:"Mage",icon:"icon_class_mage",color:"#69ccf0",tree:[["Arcane","icon_mage_arcane"],["Fire","icon_mage_fire"], ["Frost","icon_mage_frost"]]},{name:"Paladin",icon:"icon_class_paladin",color:"#f58cba",tree:[["Holy","icon_paladin_holy"],["Protection","icon_paladin_protection"],["Retribution","icon_paladin_retribution"]]},{name:"Priest",icon:"icon_class_priest",color:"#ffffff",tree:[["Discipline","icon_priest_discipline"],["Holy","icon_priest_holy"],["Shadow","icon_priest_shadow"]]},{name:"Rogue",icon:"icon_class_rogue",color:"#fff569",tree:[["Assassination","icon_rogue_assassination"],["Combat","icon_rogue_combat"], ["Subtlety","icon_rogue_subtlety"]]},{name:"Shaman",icon:"icon_class_shaman",color:"#2459ff",tree:[["Elemental","icon_shaman_elemental"],["Enhancement","icon_shaman_enhancement"],["Restoration","icon_shaman_restoration"]]},{name:"Warlock",icon:"icon_class_warlock",color:"#9482c9",tree:[["Affliction","icon_warlock_affliction"],["Demonology","icon_warlock_demonology"],["Destruction","icon_warlock_destruction"]]},{name:"Warrior",icon:"icon_class_warrior",color:"#c79c6e",tree:[["Arms","icon_warrior_arms"], ["Fury","icon_warrior_fury"],["Protection","icon_warrior_protection"]]}]};d.fn.wowTalents=function(j){return this.each(function(){new d.wowTalents(this,j)})}})(jQuery);
